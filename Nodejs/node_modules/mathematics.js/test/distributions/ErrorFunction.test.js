const ErrorFunction = require( '../../source/distributions/ErrorFunction' );
const Îµ = 0.0000001;

const stops = [ 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1, 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11, 1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18, 1.19, 1.2, 1.21, 1.22, 1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33, 1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4, 1.41, 1.42, 1.43, 1.44, 1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55, 1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.63, 1.64, 1.65, 1.66, 1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77, 1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.88, 1.89, 1.9, 1.91, 1.92, 1.93, 1.94, 1.95, 1.96, 1.97, 1.98, 1.99, 2, 2.01, 2.02, 2.03, 2.04, 2.05, 2.06, 2.07, 2.08, 2.09, 2.1, 2.11, 2.12, 2.13, 2.14, 2.15, 2.16, 2.17, 2.18, 2.19, 2.2, 2.21, 2.22, 2.23, 2.24, 2.25, 2.26, 2.27, 2.28, 2.29, 2.3, 2.31, 2.32, 2.33, 2.34, 2.35, 2.36, 2.37, 2.38, 2.39, 2.4, 2.41, 2.42, 2.43, 2.44, 2.45, 2.46, 2.47, 2.48, 2.49, 2.5, 2.51, 2.52, 2.53, 2.54, 2.55, 2.56, 2.57, 2.58, 2.59, 2.6, 2.61, 2.62, 2.63, 2.64, 2.65, 2.66, 2.67, 2.68, 2.69, 2.7, 2.71, 2.72, 2.73, 2.74, 2.75, 2.76, 2.77, 2.78, 2.79, 2.8, 2.81, 2.82, 2.83, 2.84, 2.85, 2.86, 2.87, 2.88, 2.89, 2.9, 2.91, 2.92, 2.93, 2.94, 2.95, 2.96, 2.97, 2.98, 2.99, 3, 3.01, 3.02, 3.03, 3.04, 3.05, 3.06, 3.07, 3.08, 3.09, 3.1, 3.11, 3.12, 3.13, 3.14, 3.15, 3.16, 3.17, 3.18, 3.19, 3.2, 3.21, 3.22, 3.23, 3.24, 3.25, 3.26, 3.27, 3.28, 3.29, 3.3, 3.31, 3.32, 3.33, 3.34, 3.35, 3.36, 3.37, 3.38, 3.39, 3.4, 3.41, 3.42, 3.43, 3.44, 3.45, 3.46, 3.47, 3.48, 3.49, 3.5 ]
const erf = [ 0, 0.011283416, 0.022564575, 0.033841222, 0.045111106, 0.056371978, 0.067621594, 0.07885772, 0.090078126, 0.101280594, 0.112462916, 0.123622896, 0.134758352, 0.145867115, 0.156947033, 0.167995971, 0.179011813, 0.189992461, 0.200935839, 0.211839892, 0.222702589, 0.233521923, 0.244295912, 0.2550226, 0.265700059, 0.27632639, 0.286899723, 0.297418219, 0.307880068, 0.318283496, 0.328626759, 0.33890815, 0.349125995, 0.359278655, 0.369364529, 0.379382054, 0.389329701, 0.399205984, 0.409009453, 0.4187387, 0.428392355, 0.43796909, 0.447467618, 0.456886695, 0.466225115, 0.47548172, 0.48465539, 0.493745051, 0.502749671, 0.511668261, 0.520499878, 0.52924362, 0.53789863, 0.546464097, 0.55493925, 0.563323366, 0.571615764, 0.579815806, 0.5879229, 0.595936497, 0.603856091, 0.611681219, 0.619411462, 0.627046443, 0.634585829, 0.642029327, 0.649376688, 0.656627702, 0.663782203, 0.670840062, 0.677801194, 0.68466555, 0.691433123, 0.698103943, 0.704678078, 0.711155634, 0.717536753, 0.723821614, 0.730010431, 0.736103454, 0.742100965, 0.748003281, 0.753810751, 0.759523757, 0.765142711, 0.770668058, 0.776100268, 0.781439845, 0.786687319, 0.791843247, 0.796908212, 0.801882826, 0.806767722, 0.811563559, 0.816271019, 0.820890807, 0.82542365, 0.829870293, 0.834231504, 0.83850807, 0.842700793, 0.846810496, 0.850838018, 0.854784211, 0.858649947, 0.862436106, 0.866143587, 0.869773297, 0.873326158, 0.876803102, 0.88020507, 0.883533012, 0.88678789, 0.88997067, 0.893082328, 0.896123843, 0.899096203, 0.902000399, 0.904837427, 0.907608286, 0.910313978, 0.912955508, 0.915533881, 0.918050104, 0.920505184, 0.922900128, 0.925235942, 0.927513629, 0.929734193, 0.931898633, 0.934007945, 0.936063123, 0.938065155, 0.940015026, 0.941913715, 0.943762196, 0.945561437, 0.947312398, 0.949016035, 0.950673296, 0.95228512, 0.953852439, 0.955376179, 0.956857253, 0.95829657, 0.959695026, 0.96105351, 0.9623729, 0.963654065, 0.964897865, 0.966105146, 0.967276748, 0.968413497, 0.969516209, 0.97058569, 0.971622733, 0.972628122, 0.973602627, 0.974547009, 0.975462016, 0.976348383, 0.977206837, 0.978038088, 0.97884284, 0.97962178, 0.980375585, 0.981104921, 0.981810442, 0.982492787, 0.983152587, 0.983790459, 0.984407008, 0.985002827, 0.9855785, 0.986134595, 0.986671671, 0.987190275, 0.987690942, 0.988174196, 0.988640549, 0.989090502, 0.989524545, 0.989943156, 0.990346805, 0.990735948, 0.99111103, 0.991472488, 0.991820748, 0.992156223, 0.992479318, 0.992790429, 0.99308994, 0.993378225, 0.99365565, 0.993922571, 0.994179334, 0.994426275, 0.994663725, 0.994892, 0.995111413, 0.995322265, 0.995524849, 0.995719451, 0.995906348, 0.99608581, 0.996258096, 0.996423462, 0.996582153, 0.996734409, 0.996880461, 0.997020533, 0.997154845, 0.997283607, 0.997407023, 0.997525293, 0.997638607, 0.997747152, 0.997851108, 0.997950649, 0.998045943, 0.998137154, 0.998224438, 0.998307948, 0.998387832, 0.998464231, 0.998537283, 0.998607121, 0.998673872, 0.998737661, 0.998798606, 0.998856823, 0.998912423, 0.998965513, 0.999016195, 0.99906457, 0.999110733, 0.999154777, 0.99919679, 0.999236858, 0.999275064, 0.999311486, 0.999346202, 0.999379283, 0.999410802, 0.999440826, 0.99946942, 0.999496646, 0.999522566, 0.999547236, 0.999570712, 0.999593048, 0.999614295, 0.999634501, 0.999653714, 0.999671979, 0.99968934, 0.999705837, 0.999721511, 0.9997364, 0.999750539, 0.999763966, 0.999776711, 0.999788809, 0.999800289, 0.999811181, 0.999821512, 0.999831311, 0.999840601, 0.999849409, 0.999857757, 0.999865667, 0.999873162, 0.999880261, 0.999886985, 0.999893351, 0.999899378, 0.999905082, 0.99991048, 0.999915587, 0.999920418, 0.999924987, 0.999929307, 0.99993339, 0.99993725, 0.999940898, 0.999944344, 0.999947599, 0.999950673, 0.999953576, 0.999956316, 0.999958902, 0.999961343, 0.999963645, 0.999965817, 0.999967866, 0.999969797, 0.999971618, 0.999973334, 0.999974951, 0.999976474, 0.99997791, 0.999979261, 0.999980534, 0.999981732, 0.999982859, 0.99998392, 0.999984918, 0.999985857, 0.99998674, 0.999987571, 0.999988351, 0.999989085, 0.999989774, 0.999990422, 0.99999103, 0.999991602, 0.999992138, 0.999992642, 0.999993115, 0.999993558, 0.999993974, 0.999994365, 0.999994731, 0.999995074, 0.999995396, 0.999995697, 0.99999598, 0.999996245, 0.999996493, 0.999996725, 0.999996942, 0.999997146, 0.999997336, 0.999997515, 0.999997681, 0.999997838, 0.999997983, 0.99999812, 0.999998247, 0.999998367, 0.999998478, 0.999998582, 0.999998679, 0.99999877, 0.999998855, 0.999998934, 0.999999008, 0.999999077, 0.999999141, 0.999999201, 0.999999257 ]
const erfc = [ 1, 0.988716584, 0.977435425, 0.966158778, 0.954888894, 0.943628022, 0.932378406, 0.92114228, 0.909921874, 0.898719406, 0.887537084, 0.876377104, 0.865241648, 0.854132885, 0.843052967, 0.832004029, 0.820988187, 0.810007539, 0.799064161, 0.788160108, 0.777297411, 0.766478077, 0.755704088, 0.7449774, 0.734299941, 0.72367361, 0.713100277, 0.702581781, 0.692119932, 0.681716504, 0.671373241, 0.66109185, 0.650874005, 0.640721345, 0.630635471, 0.620617946, 0.610670299, 0.600794016, 0.590990547, 0.5812613, 0.571607645, 0.56203091, 0.552532382, 0.543113305, 0.533774885, 0.52451828, 0.51534461, 0.506254949, 0.497250329, 0.488331739, 0.479500122, 0.47075638, 0.46210137, 0.453535903, 0.44506075, 0.436676634, 0.428384236, 0.420184194, 0.4120771, 0.404063503, 0.396143909, 0.388318781, 0.380588538, 0.372953557, 0.365414171, 0.357970673, 0.350623312, 0.343372298, 0.336217797, 0.329159938, 0.322198806, 0.31533445, 0.308566877, 0.301896057, 0.295321922, 0.288844366, 0.282463247, 0.276178386, 0.269989569, 0.263896546, 0.257899035, 0.251996719, 0.246189249, 0.240476243, 0.234857289, 0.229331942, 0.223899732, 0.218560155, 0.213312681, 0.208156753, 0.203091788, 0.198117174, 0.193232278, 0.188436441, 0.183728981, 0.179109193, 0.17457635, 0.170129707, 0.165768496, 0.16149193, 0.157299207, 0.153189504, 0.149161982, 0.145215789, 0.141350053, 0.137563894, 0.133856413, 0.130226703, 0.126673842, 0.123196898, 0.11979493, 0.116466988, 0.11321211, 0.11002933, 0.106917672, 0.103876157, 0.100903797, 0.097999601, 0.095162573, 0.092391714, 0.089686022, 0.087044492, 0.084466119, 0.081949896, 0.079494816, 0.077099872, 0.074764058, 0.072486371, 0.070265807, 0.068101367, 0.065992055, 0.063936877, 0.061934845, 0.059984974, 0.058086285, 0.056237804, 0.054438563, 0.052687602, 0.050983965, 0.049326704, 0.04771488, 0.046147561, 0.044623821, 0.043142747, 0.04170343, 0.040304974, 0.03894649, 0.0376271, 0.036345935, 0.035102135, 0.033894854, 0.032723252, 0.031586503, 0.030483791, 0.02941431, 0.028377267, 0.027371878, 0.026397373, 0.025452991, 0.024537984, 0.023651617, 0.022793163, 0.021961912, 0.02115716, 0.02037822, 0.019624415, 0.018895079, 0.018189558, 0.017507213, 0.016847413, 0.016209541, 0.015592992, 0.014997173, 0.0144215, 0.013865405, 0.013328329, 0.012809725, 0.012309058, 0.011825804, 0.011359451, 0.010909498, 0.010475455, 0.010056844, 0.009653195, 0.009264052, 0.00888897, 0.008527512, 0.008179252, 0.007843777, 0.007520682, 0.007209571, 0.00691006, 0.006621775, 0.00634435, 0.006077429, 0.005820666, 0.005573725, 0.005336275, 0.005108, 0.004888587, 0.004677735, 0.004475151, 0.004280549, 0.004093652, 0.00391419, 0.003741904, 0.003576538, 0.003417847, 0.003265591, 0.003119539, 0.002979467, 0.002845155, 0.002716393, 0.002592977, 0.002474707, 0.002361393, 0.002252848, 0.002148892, 0.002049351, 0.001954057, 0.001862846, 0.001775562, 0.001692052, 0.001612168, 0.001535769, 0.001462717, 0.001392879, 0.001326128, 0.001262339, 0.001201394, 0.001143177, 0.001087577, 0.001034487, 0.000983805, 0.00093543, 0.000889267, 0.000845223, 0.00080321, 0.000763142, 0.000724936, 0.000688514, 0.000653798, 0.000620717, 0.000589198, 0.000559174, 0.00053058, 0.000503354, 0.000477434, 0.000452764, 0.000429288, 0.000406952, 0.000385705, 0.000365499, 0.000346286, 0.000328021, 0.00031066, 0.000294163, 0.000278489, 0.0002636, 0.000249461, 0.000236034, 0.000223289, 0.000211191, 0.000199711, 0.000188819, 0.000178488, 0.000168689, 0.000159399, 0.000150591, 0.000142243, 0.000134333, 0.000126838, 0.000119739, 0.000113015, 0.000106649, 0.000100622, 9.49E-05, 8.95E-05, 8.44E-05, 7.96E-05, 7.50E-05, 7.07E-05, 6.66E-05, 6.28E-05, 5.91E-05, 5.57E-05, 5.24E-05, 4.93E-05, 4.64E-05, 4.37E-05, 4.11E-05, 3.87E-05, 3.64E-05, 3.42E-05, 3.21E-05, 3.02E-05, 2.84E-05, 2.67E-05, 2.50E-05, 2.35E-05, 2.21E-05, 2.07E-05, 1.95E-05, 1.83E-05, 1.71E-05, 1.61E-05, 1.51E-05, 1.41E-05, 1.33E-05, 1.24E-05, 1.16E-05, 1.09E-05, 1.02E-05, 9.58E-06, 8.97E-06, 8.40E-06, 7.86E-06, 7.36E-06, 6.89E-06, 6.44E-06, 6.03E-06, 5.64E-06, 5.27E-06, 4.93E-06, 4.60E-06, 4.30E-06, 4.02E-06, 3.76E-06, 3.51E-06, 3.28E-06, 3.06E-06, 2.85E-06, 2.66E-06, 2.49E-06, 2.32E-06, 2.16E-06, 2.02E-06, 1.88E-06, 1.75E-06, 1.63E-06, 1.52E-06, 1.42E-06, 1.32E-06, 1.23E-06, 1.15E-06, 1.07E-06, 9.92E-07, 9.23E-07, 8.59E-07, 7.99E-07, 7.43E-07 ]

UnitTest = {
	erf( test ) {
		// setup
		var values = [];

		// act
		for ( var i = 0; i < stops.length; i++ ) {
			values.push( ErrorFunctions.erf( stops[ i ] ) );
		}

		// validate
		for ( var i = 0; i < stops.length; i++ ) {
			test.ok( Math.abs( values[ i ] - erf[ i ] ) < Îµ );
		}
		test.expect( stops.length );
		test.done();
	},

	erfc( test ) {
		// setup
		var values = [];

		// act
		for ( var i = 0; i < stops.length; i++ ) {
			values.push( ErrorFunction.erfc( stops[ i ] ) );
		}

		// validate
		for ( var i = 0; i < stops.length; i++ ) {
			test.ok( Math.abs( values[ i ] - erfc[ i ] ) < Îµ );
		}
		test.expect( stops.length );
		test.done();
	},

	erfInv( test ) {
		// setup
		var values = [];
		var stop = 0;
		var Îµ = 0.0001; // TODO: Increase accuract

		// act
		for ( var i = 0; i < stops.length - stop; i++ ) {
			values.push( ErrorFunction.erfInv( erf[ i ] ) );
		}

		// validate
		for ( var i = 0; i < stops.length - stop; i++ ) {
			test.ok( Math.abs( values[ i ] - stops[ i ] ) < Îµ );
		}
		test.expect( stops.length - stop, "Error" );
		test.done();
	},
}

module.exports = UnitTest;